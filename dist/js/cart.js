"use strict";$(".person").click(function(){$(".lore").css("display","block")}),$(".close button").click(function(){$(".lore").css("display","none")});var username=tool.getCookie("username");if(username){var str=" <h2>欢迎,"+username+'</h2>\n    <a href="cart.html">查看购物车</a>\n    <br>\n    <br>\n    <a href="javascript:;" class="logout">退出</a>\n       \n    ';$(".changeShow").html(str),$(".logout").click(function(){return layer.confirm("你确定要退出吗?",{btn:["退出","取消"]},function(){layer.msg("退出成功",{icon:1,time:1500},function(){tool.removeCookie("username");$(".changeShow").html('\n                <div class="log">\n                    <h2>登录</h2>\n                    <p>登录我的账户</p>\n                    <a href="login.html">登录</a>\n                </div>\n                <div class="reg">\n                    <h2>没有账户吗?</h2>\n                    <a href="register.html">建立账户</a>\n                </div>\n                ')})}),!1})}else layer.msg("请先登录",{icon:2,time:1500},function(){localStorage.setItem("url",location.href),setTimeout(function(){location.href="login.html"},1e3)});var loadindex2=layer.load(1,{shade:[1,"#fff"]}),data=localStorage.getItem("data");if(data&&"[]"!==data){var arr=JSON.parse(data),currentArr=arr.filter(function(t){return t.username===username});if(!currentArr.length){var _str2='\n            <div class="sub">\n                <h2>购物袋为空<h2>\n                <p>您的购物袋内没有物品</p>   \n                <p>点击<a href="list.html">这里</a>来继续购物</p>  \n            </div> \n        ';$(".con-l").html(_str2)}var idsArr=currentArr.map(function(t){return t.goodsid}),idsStr=idsArr.join(",");$.get("php/cart.php",{ids:idsStr},function(t){var n=t.meta,e=n.status,a=(n.msg,t.data);if(1===e){a.forEach(function(n){currentArr.forEach(function(t){n.id===t.goodsid&&(n.count=t.count)})});var r='\n                <ul>\n                    <li><a href="#"  class="active">购物袋</a></li>\n                    <li><a href="#">订单提交</a></li>\n                    <li><a href="#">支付</a></li>\n                </ul>\n                <h2>迪奥时装</h2>\n                <h3>* 国家药监局提示您：请正确认识化妆品功效，化妆品不能替代药品, 不能治疗皮肤病等疾病</h3>\n            ';a.forEach(function(t){r+='\n                <form action="">\n                    <table class="table">\n                        \n                        <tr>\n                            <td><input type="checkbox" checked name="selectOne" /></td>\n                            <td class="tu"><img src="'+t.src+'" alt="克丽丝汀迪奥"></td>\n                            <td class="text">\n                                <h3>'+t.title+"</h3>\n                                <p>￥<span>"+t.price+"<span></p>\n                                <a>"+t.txt+'</a>\n                            </td>\n                            <td class="number">\n                                <input type="button" class="del" value="-">\n                                <span class="totalNumber">'+t.count+'</span>\n                                <input type="button" class="add" value="+">\n                            </td>\n                            <td class="money">￥ <span>'+t.price*t.count+'</span></td>\n                            <td class="cha">X</td>\n                            <td data-id="'+t.id+'" class="msg">+编辑刻字信息</td>\n                        </tr>\n                    </table>\n                </form>\n                '}),r+='\n                <tr>\n                    <td><input type="checkbox" checked name="selectAll"/></td>\n                    <td>全选</td>\n                </tr>\n                <tr class="last">    \n                    <td>总金额: ￥ <span class="allPrice">0</span> </td>\n                </tr>\n                <tr class="qingkong">    \n                    <td><input type="button" class="clearCart" value="清空购物袋" name="_clear"></td>\n                </tr>\n            ',$(".con-l").html(r),$('[name="_clear"]').css({float:"right","background-color":" #000 ",color:"#fff",height:"30px",padding:"0 10px","border-radius":"15px","font-size":"12px","margin-top":"10px",border:"none"}),selectAll(),selectOne(),add(),del(),sumPrice(),total(),delCart(),clearCart(),layer.close(loadindex2)}},"json")}else{var _str='\n        <div class="sub">\n            <h2>购物袋为空<h2>\n            <p>您的购物袋内没有物品</p>   \n            <p>点击<a href="list.html"> 这里 </a>来继续购物</p>  \n        </div> \n    ';$(".con-l").html(_str),layer.close(loadindex2)}function selectAll(){$('[name="selectAll"]').click(function(){$('[name="selectOne"]').prop("checked",$(this).prop("checked")),total()})}function selectOne(){$('[name="selectOne"]').click(function(){var t=Array.prototype.slice.call($('[name="selectOne"]')).every(function(t){return t.checked});$('[name="selectAll"]').prop("checked",t),total()})}function add(){$(".add").click(function(){var t=$(this).prev().text()-0;10<=++t&&(t=10),$(this).prev().text(t);var n=localStorage.getItem("data"),e=JSON.parse(n),a=$(this).parent().siblings().last().attr("data-id");e.find(function(t){return t.goodsid===a}).count=t,localStorage.setItem("data",JSON.stringify(e)),sumPrice(),total()})}function del(){$(".del").click(function(){var t=$(this).next().text()-0;--t<=1&&(t=1),$(this).next().text(t);var n=localStorage.getItem("data"),e=JSON.parse(n),a=$(this).parent().siblings().last().attr("data-id");e.find(function(t){return t.goodsid===a}).count=t,localStorage.setItem("data",JSON.stringify(e)),sumPrice(),total()})}function sumPrice(){$(".totalNumber").each(function(t,n){var e=$(n).text()*$(n).parent().prev().find("p span").text();$(n).parent().next().find("span").text(e)})}function total(){var r=0;$('[name="selectOne"]:checked').each(function(t,n){var e=$(n).parent().siblings(".number").find("span").text()-0;e;var a=$(n).parent().siblings(".money").find("span").text()-0;r+=a,$(".allPrice").text(r)})}function delCart(){$(".cha").click(function(){var r=this;layer.confirm("您确定要删除吗?",{btn:["确定","取消"]},function(){$(r).parent().parent().remove();var t=localStorage.getItem("data"),n=JSON.parse(t),e=$(r).parent().next().attr("data-id"),a=n.findIndex(function(t){return t.goodsid===e});if(n.splice(a,1),localStorage.setItem("data",JSON.stringify(n)),total(),layer.msg("删除成功!",{time:1e3,icon:1}),!n.filter(function(t){return t.username===username}).length){$(".con-l").html('\n                    <div class="sub">\n                        <h2>购物袋为空<h2>\n                        <p>您的购物袋内没有物品</p>   \n                        <p>点击<a href="list.html">这里</a>来继续购物</p>  \n                    </div> \n                ')}})})}function clearCart(){$(".clearCart").click(function(){layer.confirm("您确定要清空购物袋吗?",{btn:["确定","取消"]},function(){var t=localStorage.getItem("data"),n=JSON.parse(t).filter(function(t){return t.username!==username});localStorage.setItem("data",JSON.stringify(n));$(".con-l").html('\n            <div class="sub">\n                <h2>购物袋为空<h2>\n                <p>您的购物袋内没有物品</p>   \n                <p>点击<a href="list.html">这里</a>来继续购物</p>  \n            </div> \n            '),layer.msg("删除成功!",{time:1e3,icon:1})})})}